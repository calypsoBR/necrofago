<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NECR√ìFAGO - N√∫cleo de Controle</title>
  <style>
    /* Seus estilos originais permanecem exatamente iguais */
    body {
      background-color: #000;
      color: #0f0;
      font-family: 'Courier New', monospace;
      text-align: center;
      padding: 50px;
      margin: 0;
    }
    .blink {
      animation: blink 1s infinite;
    }
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0; }
    }
    #alerta {
      color: red;
      font-size: 1.5em;
      display: none;
    }
    #permissao {
      color: red;
      font-size: 1.2em;
      display: none;
      margin: 20px 0;
    }
    #container {
      margin-top: 30px;
    }
    input, button {
      background-color: #111;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 10px;
      font-size: 1em;
      margin: 10px;
    }
    #timer {
      color: yellow;
      font-size: 1.5em;
      margin: 20px 0;
    }
    #logo {
      width: 150px;
      margin-bottom: 20px;
    }
    .tela-cheia {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #000;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 100;
    }
    #resposta {
      min-height: 30px;
      margin: 10px 0;
    }
    .fade-in {
      animation: fadeIn 3s;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .dancing-couple {
      width: 300px;
      margin-top: 20px;
      opacity: 0;
      animation: fadeInGif 2.5s forwards 0.5s;
    }
    @keyframes fadeInGif {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <!-- Seu conte√∫do HTML original permanece igual -->
  <div id="main">
    <img id="logo" src="https://cdn.glitch.global/85c0c604-0dea-4b74-942d-caabf5846256/thumbnails%2Fnecr%C3%B3fago_logo.png?1751802107893" alt="NECR√ìFAGO">
    <div id="alerta" class="blink">‚ö†Ô∏è NECR√ìFAGO DETECTOU A SUA PRESEN√áA ‚ö†Ô∏è</div>
    <div id="permissao">PARE! Voc√™ n√£o tem permiss√£o para acessar este n√∫cleo!</div>

    <div id="container">
      <p>Insira o comando de reinicializa√ß√£o:</p>
      <input type="text" id="comando" placeholder="Digite o comando..." 
             onclick="mostrarPermissao(); tocarSirene()" 
             onfocus="tocarSirene()">
      <button onclick="verificarComando()">ENVIAR</button>
      <div id="resposta"></div>
      <div id="timer">Tempo restante: 20:00</div>
    </div>
  </div>

  <audio id="sirene" preload="auto" loop>
    <source src="https://archive.org/download/siren-alarm-sound-effects/Siren%20Alarm%20Sound%20Effects.mp3" type="audio/mpeg">
  </audio>

  <audio id="daisy" preload="auto">
    <source src="https://ia902807.us.archive.org/1/items/78_daisy-bell-bicycle-built-for-two_dana-harmonizers-dana-ensemble-harry-dacre_gbia0060910a/Daisy%20Bell%20Bicycle%20Buil%20-%20Dana%20Harmonizers%20%28Dana%20Ensemble%29.mp3" type="audio/mpeg">
  </audio>

  <script>
    // ========== SISTEMA DE BLOQUEIO ROBUSTO ========== //
    const BLOQUEIO_DURACAO = 4 * 60 * 1000; // 4 minutos para testes
    const dataAtivacao = new Date("2025-07-11T03:33:00"); // Data alterada para testes
    let bloqueioAtivo = false;
    let tentativasRestantes = 3;

    // Verifica bloqueio existente ao carregar
    if (sessionStorage.getItem('necrofago_bloqueio')) {
      iniciarBloqueio();
    }

    function iniciarBloqueio() {
      bloqueioAtivo = true;
      sessionStorage.setItem('necrofago_bloqueio', 'true');
      
      // 1. Bloqueia teclas de atualiza√ß√£o
      document.addEventListener('keydown', function(e) {
        if (bloqueioAtivo) {
          // Bloqueia F5, Ctrl+R, Ctrl+F5, etc.
          if (e.key === 'F5' || e.key === 'F11' || 
             (e.ctrlKey && e.key === 'r') || 
             (e.ctrlKey && e.key === 'F5') ||
             (e.metaKey && e.key === 'r')) {
            e.preventDefault();
            e.stopImmediatePropagation();
            window.location.reload(); // For√ßa recarregar mantendo o bloqueio
          }
        }
      });

      // 2. Bloqueia bot√£o direito e menu de contexto
      document.addEventListener('contextmenu', function(e) {
        if (bloqueioAtivo) {
          e.preventDefault();
          return false;
        }
      });

      // 3. Manipula o evento beforeunload
      window.addEventListener('beforeunload', function(e) {
        if (bloqueioAtivo) {
          e.preventDefault();
          // Mensagem que aparece ao tentar fechar
          e.returnValue = 'A NECR√ìFAGO bloqueou esta sess√£o. Suas tentativas n√£o ser√£o resetadas.';
          return e.returnValue;
        }
      });

      // 4. Verifica√ß√£o peri√≥dica para evitar bypass
      setInterval(() => {
        if (bloqueioAtivo) {
          sessionStorage.setItem('necrofago_bloqueio', 'true');
        }
      }, 1000);

      // Remove o bloqueio ap√≥s o tempo estipulado
      setTimeout(() => {
        finalizarBloqueio();
      }, BLOQUEIO_DURACAO);
    }

    function finalizarBloqueio() {
      bloqueioAtivo = false;
      sessionStorage.removeItem('necrofago_bloqueio');
      window.location.reload();
    }

    // ========== SEU C√ìDIGO ORIGINAL (COM MODIFICA√á√ïES) ========== //
    const agora = new Date();
    if (agora < dataAtivacao) {
      document.body.innerHTML = `
        <style>
          body {
            background-color: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            text-align: center;
            padding-top: 100px;
          }
          .negado {
            color: red;
            font-size: 3em;
            animation: blink 1s infinite;
          }
          @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
          }
        </style>
        <div>
          <h1 class="negado">‚ùå ACESSO NEGADO!</h1>
          <p>Acesse na data e hora correta da pr√≥xima janela de recertifica√ß√£o.</p>
        </div>
      `;
      throw new Error("Acesso bloqueado por hor√°rio.");
    }

    let tempo = 20 * 60;
    let bloqueado = false;

    const timerEl = document.getElementById("timer");
    const container = document.getElementById("container");
    const daisy = document.getElementById("daisy");
    const sirene = document.getElementById("sirene");
    const alerta = document.getElementById("alerta");
    const resposta = document.getElementById("resposta");

    setTimeout(() => {
      alerta.style.display = "block";
    }, 2000);

    const intervalo = setInterval(updateTimer, 1000);

    function updateTimer() {
      const minutos = Math.floor(tempo / 60);
      const segundos = tempo % 60;
      timerEl.textContent = `Tempo restante: ${minutos}:${segundos.toString().padStart(2, '0')}`;
      tempo--;

      if (tempo < 0) {
        clearInterval(intervalo);
        mostrarTelaCheia("‚õî Janela de reinicializa√ß√£o encerrada. Uma nova janela ocorrer√° na pr√≥xima migra√ß√£o da NECR√ìFAGO.", "red");
        sirene.pause();
      }
    }

    function mostrarPermissao() {
      document.getElementById("permissao").style.display = "block";
    }

    function tocarSirene() {
      if (!bloqueado && !bloqueioAtivo) {
        sirene.play().catch(e => console.log("Erro na sirene:", e));
      }
    }

    function verificarComando() {
      if (bloqueado || bloqueioAtivo) return;

      const comando = document.getElementById("comando").value.trim();

      if (comando === "REBOOT-NECRO") {
        reiniciarNecrofago();
      } else {
        tentativasRestantes--;
        if (tentativasRestantes <= 0) {
          bloquearAcesso();
        } else {
          resposta.innerHTML = `<p style="color:red;">‚ùå Comando incorreto. Tentativas restantes: ${tentativasRestantes}</p>`;
        }
      }
    }

    function reiniciarNecrofago() {
      clearInterval(intervalo);
      sirene.pause();
      
      daisy.play().catch(e => {
        console.log("Erro na m√∫sica:", e);
        document.getElementById("resposta").innerHTML = "<p style='color:orange;'>üîá Ative o som para ouvir a m√∫sica</p>";
      });

      const tela = document.createElement("div");
      tela.className = "tela-cheia";
      document.body.appendChild(tela);
      
      setTimeout(() => {
        tela.innerHTML = '<div class="blink" style="color:red;font-size:2em;">üß† NECR√ìFAGO SENDO REINICIALIZADA...</div>';
        
        setTimeout(() => {
          tela.innerHTML = `
            <div class="fade-in" style="color:lime;font-size:2em;margin-bottom:20px;">
              ‚úÖ Sucesso! Voc√™ conseguiu destruir a Necr√≥fago!
            </div>
            <img class="dancing-couple" src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExemt1enVwbDg3ZnYyd2V1MXEwajNsYXoxYWc1Zmo1d2pqZGNrMjVyeiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3ornjRp9AZrq594Mms/giphy.gif" alt="Dan√ßa cl√°ssica">
          `;
        }, 5000);
      }, 7000);
    }

    function bloquearAcesso() {
      bloqueado = true;
      clearInterval(intervalo);
      sirene.pause();
      mostrarTelaCheia("üö´ ACESSO BLOQUEADO PERMANENTEMENTE.", "red");
      iniciarBloqueio(); // Ativa o sistema anti-atualiza√ß√£o
    }

    function mostrarTelaCheia(mensagem, cor) {
      const tela = document.createElement("div");
      tela.className = "tela-cheia";
      tela.innerHTML = `<div style="color:${cor}; font-size:2em;">${mensagem}</div>`;
      document.body.appendChild(tela);
    }
  </script>
</body>
</html>
